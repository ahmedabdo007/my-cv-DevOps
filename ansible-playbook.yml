---
- name: "build container with ansible"
  hosts: localhost
  tasks:
  - name: stop running cv-container
    command: docker stop cv-container
    ignore_errors: yes

  - name: remove cv-container
    command: docker rm cv-container
    ignore_errors: yes

  - name: remove cv-img
    command: docker rmi cv-img
    ignore_errors: yes

  - name: build docker image from dockerfile
    command: docker build -t cv-img .

  - name: create tag to image
    command: docker tag cv-img ahmedabdoahmed/cv-website


  - name: push image to dockerhub
    command: docker push ahmedabdoahmed/cv-website 
    ignore_errors: yes
    
  - name: run container from cv-img
    command: docker run -d --name cv-container -p 5000:80 cv-img 
